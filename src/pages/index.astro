---
import Layout from '../layouts/Layout.astro';

const navItems = [
  {
    title: 'åšå®¢æ–‡ç« ',
    desc: 'æ·±åº¦æ€è€ƒä¸æŠ€æœ¯å¤ç›˜',
    href: '/blog/',
    icon: 'âœï¸',
    color: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
  },
  {
    title: 'ç¢ç‰‡ç¬”è®°',
    desc: 'æ—¥å¸¸çµæ„Ÿä¸å¿«é€Ÿè®°å½•',
    href: '/notes/',
    icon: 'ğŸ““',
    color: 'linear-gradient(135deg, #FF9A9E 0%, #FECFEF 99%, #FECFEF 100%)'
  },
  {
    title: 'æ–‡ä»¶æ±‡æ€»',
    desc: 'ç½‘ç›˜èµ„æºä¸å·¥å…·åˆ†äº«',
    href: '/files/',
    icon: 'ğŸ“‚',
    color: 'linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%)'
  }
];
---

<Layout title="æ¬¢è¿æ¥åˆ°æˆ‘çš„æ•°å­—èŠ±å›­">
  
  <!-- âœ¨ åŠ¨æ€èƒŒæ™¯ç”»å¸ƒ âœ¨ -->
  <canvas id="background-canvas"></canvas>

  <div class="home-container">
    <!-- Hero åŒºåŸŸ -->
    <header class="hero">
      <h1 class="animate-title">Hello, <span class="text-gradient">World!</span></h1>
      <p class="animate-subtitle">æ¬¢è¿æ¥åˆ° blogs.ssfrg.comï¼Œè¿™é‡Œè®°å½•ç€æˆ‘çš„æ•°å­—è¶³è¿¹ã€‚</p>
    </header>

    <!-- å¯¼èˆªå¡ç‰‡åŒºåŸŸ -->
    <nav class="nav-grid">
      {navItems.map((item, index) => (
        <a href={item.href} class="nav-card" style={`--delay: ${index * 0.1 + 0.3}s`}>
          <div class="icon-box" style={`background: ${item.color}`}>
            {item.icon}
          </div>
          <div class="content">
            <h2>{item.title}</h2>
            <p>{item.desc}</p>
          </div>
          <div class="arrow">â†’</div>
        </a>
      ))}
    </nav>
  </div>
</Layout>

<script>
  // âœ¨ åŠ¨æ€ç²’å­æ•ˆæœè„šæœ¬ (çº¯åŸç”Ÿ JS)
  // ä½¿ç”¨ astro:page-load ç¡®ä¿åœ¨é¡µé¢åˆ‡æ¢åä¾ç„¶ç”Ÿæ•ˆ
  document.addEventListener('astro:page-load', () => {
    const canvas = document.getElementById('background-canvas') as HTMLCanvasElement;
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    let particlesArray;

    // è®¾ç½®ç”»å¸ƒå¤§å°
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // é¼ æ ‡äº¤äº’å¯¹è±¡
    let mouse = {
      x: null,
      y: null,
      radius: (canvas.height / 80) * (canvas.width / 80)
    }

    window.addEventListener('mousemove', (event) => {
      mouse.x = event.x;
      mouse.y = event.y;
    });

    // ç²’å­ç±»
    class Particle {
      x: number;
      y: number;
      directionX: number;
      directionY: number;
      size: number;
      color: string;

      constructor(x, y, directionX, directionY, size, color) {
        this.x = x;
        this.y = y;
        this.directionX = directionX;
        this.directionY = directionY;
        this.size = size;
        this.color = color;
      }

      // ç»˜åˆ¶ç²’å­
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
        ctx.fillStyle = this.color;
        ctx.fill();
      }

      // æ›´æ–°ç²’å­ä½ç½®
      update() {
        // è¾¹ç•Œæ£€æµ‹ï¼šç¢°åˆ°å±å¹•è¾¹ç¼˜åå¼¹
        if (this.x > canvas.width || this.x < 0) {
          this.directionX = -this.directionX;
        }
        if (this.y > canvas.height || this.y < 0) {
          this.directionY = -this.directionY;
        }

        // é¼ æ ‡äº’åŠ¨æ£€æµ‹ï¼šå¦‚æœé¼ æ ‡åœ¨é™„è¿‘ï¼Œç²’å­ä¼šè¢«æ¨å¼€ä¸€ç‚¹ç‚¹ï¼ˆæ’æ–¥åŠ›ï¼‰æˆ–è€…å¸å¼•
        // è¿™é‡Œåšä¸€ä¸ªç®€å•çš„è¿æ¥æ£€æµ‹é€»è¾‘åœ¨ connect() å‡½æ•°é‡Œï¼Œè¿™é‡Œåªè´Ÿè´£ç§»åŠ¨
        this.x += this.directionX;
        this.y += this.directionY;

        this.draw();
      }
    }

    // åˆå§‹åŒ–ç²’å­æ•°ç»„
    function init() {
      particlesArray = [];
      // ç²’å­æ•°é‡ï¼šæ ¹æ®å±å¹•å¤§å°è®¡ç®—ï¼Œå±å¹•è¶Šå¤§ç²’å­è¶Šå¤š
      let numberOfParticles = (canvas.height * canvas.width) / 9000;
      for (let i = 0; i < numberOfParticles; i++) {
        let size = (Math.random() * 3) + 1; // ç²’å­å¤§å° 1-4px
        let x = (Math.random() * ((innerWidth - size * 2) - (size * 2)) + size * 2);
        let y = (Math.random() * ((innerHeight - size * 2) - (size * 2)) + size * 2);
        // é€Ÿåº¦ï¼šéšæœºæ–¹å‘ï¼Œé€Ÿåº¦æ…¢ä¸€ç‚¹åˆ¶é€ æ¼‚æµ®æ„Ÿ
        let directionX = (Math.random() * 1) - 0.5; 
        let directionY = (Math.random() * 1) - 0.5;
        let color = 'rgba(120, 120, 150, 0.2)'; // æ·¡æ·¡çš„è“ç°è‰²ï¼ŒåŠé€æ˜

        particlesArray.push(new Particle(x, y, directionX, directionY, size, color));
      }
    }

    // è¿çº¿å‡½æ•°ï¼šå¦‚æœç²’å­ä¹‹é—´è·ç¦»å¤Ÿè¿‘ï¼Œå°±ç”»çº¿
    function connect() {
      let opacityValue = 1;
      for (let a = 0; a < particlesArray.length; a++) {
        for (let b = a; b < particlesArray.length; b++) {
          let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x)) + 
                         ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
          
          // å¦‚æœè·ç¦»å°äºè¿™ä¸ªå€¼ï¼Œå°±è¿çº¿
          if (distance < (canvas.width / 7) * (canvas.height / 7)) {
            opacityValue = 1 - (distance / 20000);
            ctx.strokeStyle = 'rgba(140, 140, 170,' + opacityValue * 0.15 + ')'; // çº¿æ¡é¢œè‰²ï¼Œéå¸¸æ·¡
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
            ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
            ctx.stroke();
          }
        }
      }
    }

    // åŠ¨ç”»å¾ªç¯
    function animate() {
      requestAnimationFrame(animate);
      ctx.clearRect(0, 0, innerWidth, innerHeight);

      for (let i = 0; i < particlesArray.length; i++) {
        particlesArray[i].update();
      }
      connect(); // è°ƒç”¨è¿çº¿
    }

    // ç›‘å¬å±å¹•å¤§å°æ”¹å˜
    window.addEventListener('resize', () => {
      canvas.width = innerWidth;
      canvas.height = innerHeight;
      init();
    });

    init();
    animate();
  });
</script>

<style>
  /* ç”»å¸ƒæ ·å¼ï¼šå›ºå®šåœ¨æœ€åº•å±‚ */
  #background-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1; /* æ”¾åœ¨æ‰€æœ‰å†…å®¹åé¢ */
    background: #f8f9fa; /* å…œåº•èƒŒæ™¯è‰² */
  }

  /* å®¹å™¨å¸ƒå±€ */
  .home-container {
    padding: 4rem 1rem;
    max-width: 900px;
    margin: 0 auto;
    position: relative;
    z-index: 1; /* ç¡®ä¿å†…å®¹åœ¨ç”»å¸ƒä¸Šé¢ */
  }

  /* Hero åŒºåŸŸ */
  .hero {
    text-align: center;
    margin-bottom: 5rem;
  }

  h1 {
    font-size: 4rem;
    font-weight: 800;
    margin: 0;
    line-height: 1.1;
    color: #1a202c;
    letter-spacing: -0.02em;
  }

  .text-gradient {
    background: linear-gradient(120deg, #845ec2, #d65db1);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .hero p {
    font-size: 1.25rem;
    color: #4a5568;
    margin-top: 1.5rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
  }

  /* å¯¼èˆªå¡ç‰‡ç½‘æ ¼ */
  .nav-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
  }

  .nav-card {
    position: relative;
    display: flex;
    align-items: center;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.8); /* åŠé€æ˜èƒŒæ™¯ï¼Œè®©ç²’å­åœ¨ä¸‹é¢è‹¥éšè‹¥ç° */
    backdrop-filter: blur(10px); /* æ¯›ç»ç’ƒç‰¹æ•ˆ */
    border-radius: 20px;
    text-decoration: none;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.6);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    
    opacity: 0;
    animation: fadeUp 0.8s ease-out forwards;
    animation-delay: var(--delay);
  }

  .nav-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    background: rgba(255, 255, 255, 0.95);
  }

  .icon-box {
    width: 56px;
    height: 56px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.75rem;
    margin-right: 1.25rem;
    flex-shrink: 0;
    color: white;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .content h2 {
    margin: 0;
    font-size: 1.35rem;
    color: #2d3748;
    font-weight: 700;
  }

  .content p {
    margin: 0.3rem 0 0 0;
    font-size: 0.9rem;
    color: #718096;
  }

  .arrow {
    margin-left: auto;
    font-size: 1.25rem;
    color: #cbd5e0;
    opacity: 0;
    transform: translateX(-10px);
    transition: all 0.3s ease;
  }

  .nav-card:hover .arrow {
    opacity: 1;
    transform: translateX(0);
    color: #845ec2;
  }

  /* åŠ¨ç”»å®šä¹‰ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .animate-title { animation: fadeUp 0.8s ease-out forwards; }
  .animate-subtitle { opacity: 0; animation: fadeUp 0.8s ease-out 0.2s forwards; }

  @media (max-width: 640px) {
    h1 { font-size: 2.8rem; }
    .hero { margin-bottom: 3rem; }
    .nav-card { padding: 1.5rem; }
  }
</style>
